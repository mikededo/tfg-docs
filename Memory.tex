% !TeX spellcheck = en_GB 

\documentclass[a4paper, 12pt, oneside]{book}

\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[pagestyles]{titlesec}
\usepackage{titletoc}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage[a4paper, margin = 2.5cm, headheight=14pt]{geometry}
\usepackage[hidelinks, colorlinks = false]{hyperref}
\usepackage[bottom]{footmisc}
\usepackage{bookmark}
\usepackage{fontspec}
\usepackage{graphicx}
\usepackage[labelfont = bf]{caption}
\usepackage{etoolbox}

\title{
	\includegraphics[width=0.75\textwidth]{assets/logo.png}
	\\
	{\huge Hubble, a gym bookings manager}
}
\author{Miquel de Domingo i Giralt}

\setmainfont{SF Pro Display}[BoldFont = SF Pro Display Bold]
\setmonofont[Scale=0.9]{JetBrains Mono}

% Variable with the page that keeps the footer style
\def\footerstyle{- \fontsize{10pt}{10pt}\selectfont\thepage\ -}
\pagestyle{fancy}
% Remove the horizontal bar from the header
\renewcommand{\headrulewidth}{0pt}
% Clear everythihg
\fancyhf{}
% Set header style
\rhead{\small\textit{\nouppercase{\rightmark}}}
% Set the footer page number
\fancyfoot[C]{\footerstyle}
% Update the footer in chapter and other plain views
\fancypagestyle{plain}{%
    \renewcommand{\headrulewidth}{0pt}%
    \fancyhf{}%
    \fancyfoot[C]{\footerstyle}%
}

\setlength\parindent{0pt}
\setcounter{secnumdepth}{5}
\setcounter{tocdepth}{5}

\titleformat{\chapter}[hang]{\normalfont\huge\bfseries}{\thechapter. }{4pt}{\Huge}
\titlespacing{\chapter}{0pt}{-32pt}{12pt}

\begin{document}
\frontmatter
\maketitle
\newpage\null\thispagestyle{empty}\newpage
\thispagestyle{empty}
\begin{flushright}
	\emph{Some dedications to the people I care for.}
\end{flushright}
\newpage
\thispagestyle{empty}
\tableofcontents
\newpage
\listoffigures
\newpage\null\thispagestyle{empty}\newpage
\mainmatter
\chapter{Introduction, motivation, purpose and project goals}
\chapter{Viability study}
\chapter{Methodology}
\section{Introduction}
In this chapter, it will be briefly explained what project management will be utilised and the development methodology. Both decisions are crucial and will have effect in how the project is planned and evolves.
\section{Project management: \emph{PMBOK}}
The methodology used to develop the overall project has been the \emph{PMBOK} which has been explained in one of the subjects of the degree. Such methodology ha become a standard in the project management world. Since it is considered as the book of books when it comes to project management, it is definitely useful to be used in any project, which, most likely, will require some sort of management.
\\[8pt]
The PMBOK methodology is explained in the \emph{Project Management Body of Knowledge} book, in which such standards and guidelines are explained more in depth. The book is produced and updated by the \emph{Project Management Institute} (\emph{PMI}) and it currently has 6 editions, the latest one released in 2017.
\\[8pt]
The procedure is based in five process groups, which are:
\begin{enumerate}[label = \arabic{*}.]
	\item \textbf{Initiating}: the initiating processes are those which are performed in order to define the project or an upcoming phase of an existing project, and obtain permission to execute the project or phase.
	\item \textbf{Planning}: the planning processes are those which are required to clearly define the scope, the objectives and the course of action of the project.
	\item \textbf{Execution}: the planning processes are those which are performed to complete the work that has been defined in the previous processes in order to satisfy the project specifications.
	\item \textbf{Monitoring and controlling}: the processes involved in this group, are required to track, regulate and review the progress and performance of the project. It identifies areas in which the plan has to change and initiates the corresponding changes.
	\item \textbf{Closing}: the closing processes are those which are performed in order to finalize all activities across the above process groups so the project or phase can be closed.
\end{enumerate}
\chapter{Framework and previous concepts}
\chapter{Requirements specifications}
\section{Introduction}
This chapter will cover the system requirements specification (\emph{SRS}) for the software being developed. The goal of this chapter is to establish the basis for what will be developed, taking into account user needs, functional and non-functional requirements.
\subsection{Purpose}
The application's objective is to provide a simple, scalable and powerful platform to handle gymnasium appointments. Gymnasium owners will be able to create their gymnasium zones and modify the constraints such as total capacity, available hours, closed days as needed. On the other side, gymnasium clients will be able to book an appointment to the gymnasiums they are subscribed to.
\\[8pt]
Therefore, in a single application, gym owners and their workers will be able to control the flow of clients; while at the same time being able to apply changes and modifications as wanted.
\subsection{Motivation}
Due to the COVID-19, most of the business have been affected by the government regulations, which did not allow more than some percentage of the total capacity of the place. Gymnasiums have been one of them and the owners have had the need to find a software that allows them to handle the amount of users their facilities can have. Moreover, some of them offer guided classes such as spinning, zumba and many more (some gymnasiums are guided classes based).
\\[8pt]
As a client myself, I have found the software used in my gym slow, continuously causing errors and not the most intuitive for the client.
\subsection{Definitions}
There are some definitions to be explained before moving to the next section:
\begin{enumerate}[label = -]
	\item \emph{Gym}. The gym will represent the company overall, not the infrastructure. Such infrastructure is called \emph{virtual gym}.
	\item \emph{Virtual gym}. A virtual gym will be the representation of a gymnasium in the application. A \emph{virtual gym} can have multiple \emph{gym zones}.
	\item \emph{Gym zone}. A gym zone will be the places where clients will book appointments.
	\item \emph{User}. The \emph{user} is the main person who uses the software. In this case, it is the owner and their workers.
	\item \emph{Template classes}. Even though the class concept is explained in further sections, it is important to make a distinction between a \emph{class} and \emph{class template}, \emph{template classes} or \emph{template events} (as they are named in the database). On the one hand, classes will be assigned to a gym zone and scheduled. On the other hand, \emph{template classes} will be used to schedule and link to a zone.
	\item \emph{Archiving} vs \emph{Deleting}. The purpose of archiving anything in the database means it will be stored but not visible. In order to edit it again, the archived element has to be \emph{recovered}. On the other hand, a deleted element will permanently be deleted from the database.
\end{enumerate}
\section{Overall description}
\subsection{Introduction}
This section provides a general explanation about the application, how it is intended to work, the different \emph{personas} to whom it is focused and a brief introduction to the software's functionalities.
\subsection{Product description}
The product will provide a rich interface for the gym owners and their coworkers in order to manage their gymnasiums. Managers will create virtual gyms, each of one with different constrains, which will be forwarded to their gym zones. Each gym zone will be of a certain type, for example, a cardio zone, a free-weight zone or even a powerlifting zone. Such and more characteristics will be determined by the workers. Once determined the capabilities of each zone, the clients will have the possibility to make their reservations.
\\[8pt]
This software is going to be interesting since it is mainly focused on the managing of appointments. There exist multiple manager systems, some are gym-focused yet there are few that provide an exclusive focus to managing the appointments. It is interesting to have an application that is that specific because most of the companies already have their client management system and other tools. The COVID has changed many things extremely fast and some gymnasiums have not been able to adapt fast enough. That is because using other management tools would mean to change the entire managing software of the company, in order words, starting from zero again.
\\[8pt]
Here is where the application becomes more interesting. It allows the company to merely incorporate the incoming software without the need of modifying the entire client management system.
\subsection{User needs}
After having briefly defined the application, two \emph{personas} can be identified: the owner or worker of the gym, and the client.
\\[8pt]
In the following sections, a brief explanation will be given about the functional requirements, yet such requirements will be explained more in depth in later sections.
\subsubsection{Owner or worker}
Such persona needs entire access to the management system, and it is the main user of it. For this persona, the following needs can be defined:
\begin{enumerate}[label = -]
	\item \emph{Ability to create virtual gyms and gym zones}. It is the main purpose of the application. It has to provide all the tools that are required to have an above average managing system.
	\item \emph{Modify virtual gyms and gym zones}. Constraints may change during time. Overall capacity may increase, more cardio machines may be added, and, with these changes, the gym zones will have to adapt to such real life modifications. There has to exist an interface that provides an easy and simple tool to control it.
	\item \emph{Ability to manage clients}. The income of the gymnasium is based on the amount of clients they have, and such clients have to be subscribed into the system. However, the application is not a client management system. It purely focuses on the fact of bookings. Therefore, the user needs to be able to synchronize their clients with the system.
	\item \emph{Ability to manage appointments}. The workers have to be able to create, modify or delete the appointments at any time. This process has to be fast and simple, since it is more than usual to have cancellations, clients without reservation, and many more.
	\item \emph{Ability to manage guided classes}. Some gym zones will be marked as a guided class zone. Therefore, a schedule will have to be set up for such zone in order to let the user know that.
\end{enumerate}
Furthermore, two user profiles have to be differentiated: the \emph{owner} and the \emph{worker}. The owner needs more control than the worker and some additional needs are:
\begin{enumerate}[label = -]
	\item \emph{Ability to manage workers}. The owner has to be able to add, remove or update their workers. There must exist an interface that allows such control.
	\item \emph{Ability to manage the privileges of the workers}. In large gymnasium franchises, there may exist different types of workers, each with different tasks. For instance, some may only be able to manage guided sessions, others will manage the client subscriptions and so on. Therefore, a privilege system is required to define a hierarchy in the company.
	\item \emph{Ability to manage gym trainers}. It is important to know what trainers will be responsible for each guided class. For instance, some clients may prefer some trainers than others, when choosing a guided class.
\end{enumerate}
\subsubsection{Client}
The client has little interaction with the system. However, a management application for clients would be pointless if clients could not book their sessions. That is why it will exist another platform to provide access to the client. Such client, will have the following needs:
\begin{enumerate}[label = -]
	\item \emph{Ability to create, modify and delete appointments}. The clients will make the most use of the reservation system. There has to exist a simple and intuitive interface that allows the clients to interact with the system.
	\item \emph{Ability to visualise guided classes}. In case the client prefers booking a place for a guided class, it should be able to visualise all the possible classes for a day or week, for a zone.
\end{enumerate}
\section{Product functionalities}
The goal of this section is to explain how would the basic flow of the application be. From the owner arranging virtual gyms, the classes and assigning the trainers; to the client being able to manage their appointments. By exemplifying the application behavior, it will be easier to determine the functional requirements of the software.
\subsection{Gym}
When registering, the owner will be required to enter the gym information and will be able to customise other information such as the gym contact data. Such settings will be common to all clients and workers, as they will be part of such gym.
\subsection{Virtual gym and gym zones}
The interface has to be intuitive both for the user and the client, while at the same time providing as much utility as possible. Before being able to create appointments, the client needs a place to create such appointments. Therefore, the first mission of the owner is to define each zone. A gym company may have one or more virtual gyms. As stated before, a virtual gym is the representation of the gym infrastructure in the system. Each virtual gym will have different characteristics and information as: the gym location, the total capacity, the opening and closing hours and much more. This virtual gyms can be modified as they may change time to time. If ever needed, the fact of deleting the different virtual gyms will also be possible.
\\[8pt]
Once the virtual gym has been set up, it can have gym zones. Each gym zone will also have its characteristics, most of them similar to the virtual gym ones. However, there is a characteristic that is important to mention: the \emph{type} of the gym zone. Each zone is required a type since some zones may be suitable for classes and some not. Such types will be predefined, however the user will have the ability to create their own types, reducing the restrictions of the application. Nonetheless, there will still be the need of distinction between class zones and non-class zones.
\subsection{Classes, trainers and workers}
After having defined the structure of the gym, the owner or the workers of the gym can create and schedule classes for the different gym zones. Classes can not be overlapped in the same zone, yet some classes can be scheduled at the same time in different zones. Furthermore, the same class can be done in multiples zones, with different trainers.
\\[8pt]
In order to keep such consistency, the gym owners will create \emph{template classes}, which will have specific characteristics. Each template class will be unique, and it will be used to create \emph{classes}. In short, the client will create an appointment to a class, which will be a scheduled template class. Nonetheless, appointments will also be required for non-class gym zones, as it is needed to know how many users will access such zone in a certain time. With the explained relation, owners and workers will not have the need to create a class with all the details every single time, rather simply scheduling already created template classes.
\\[8pt]
Additionally, a trainer manager system is required. However, a trainer it is a worker as well, even though it does not interact with the application. Hence, in the same management view, the owner, and if any worker is allowed to, will be able to create trainers and workers.
\subsection{Clients}
Before continuing, the system still lacks of the main income of the gymnasium: the client. As detailed before, the goal of this application is not to provide a client management system, though it could be a functionality to be implemented in the future. Therefore, the client will also be related to the gym entity.
\\[8pt]
There has to be, definitely, a small client management. However, this management does not need to know about all the information it is kept about the user in the gym. It will only need:
\begin{enumerate}[label = -]
	\item Personal information such as the name, last name and so on. It should include an email and a code (which can be generated by the application) to log in to the software.
\end{enumerate}
That is it. From there, the client will have access to another view of the application in which they will be able to make the reservations.
\subsection{Creating appointments}
When the client has been able to connect to the platform, they will be able to visualise the virtual gyms of the gym they belong to. There, the client will be able to visualise the availability of the different gym zones, the classes offered in that zone and other relevant information. From that, they will create their appointment which will be persisted to the system.
\\[8pt]
After the appointment has been made, the client will be able to modify it and remove it, without the need of any explanation.
\section{Functional requirements}
\subsection{Introduction}
In this section, the above described requirements will be explained more in depth. The functional requirements are defined as the core functionalities of the system. All requirements exposed in the section are considered essentials and the system would be considered incomplete if it did not satisfy such requisites.
\\[8pt]
The requisites will be exposed with their code name and a number (as \emph{FR-1}), their priority and a brief description. Three levels of priority have been defined:
\begin{enumerate}[label = \arabic{*}.]
	\item \textbf{High priority (3)}. Such requisites must be fulfilled by the application in order to provide a proper user experience.
	\item \textbf{Medium priority (2)}. Such requisites should be fulfilled by the application in order to provide an above average user experience.
	\item \textbf{Low priority (1)}. Such requisites would provide an excellent user experience, yet they are not mandatory.
\end{enumerate}
Furthermore, the overall application will be separated in three different front end applications:
\begin{enumerate}[label = \textbf{\arabic{*}.}]
	\item \textbf{Landing app}. Application which contains the landing application of the product.
	\item \textbf{Core app}. Main application of the product, where the user does most of the work.
	\item \textbf{Appointments app}. Application used by the gym client in order to book their appointments.
\end{enumerate}
\subsection{Landing app - Product information}
The application must have a landing page in which the potential user can find the different features offered by the application.
\begin{enumerate}[label = -]
	\item \textbf{FR-1 (3)}. The user needs to know the different features of the product in a single page.
	\item \textbf{FR-2 (3)}. The user needs to be able to be redirected to the register and login page, from the landing page. Such page is the core page.
	\item \textbf{FR-3 (2)}. The user needs to be able to find a contact page in the landing page and ask for the desired information by providing personal information.
	\item \textbf{FR- (3)}. The user needs to find information about the data privacy. No personal data and information is intended to be sold, nor shared.
\end{enumerate}
\subsection{Core app - User registration}
The user has to be able to register. In the beginning, the application will be completely free, so the gym owners will have complete access only by registering. A future implementation would be to provide additional features only to the users with a subscription.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The user has to provide personal information in order to register.
	\item \textbf{FR- (3)}. The user has to provide information about the gym in order to register.
	\item \textbf{FR- (3)}. The user has to provide an email and a password to access the application (log in).
	\item \textbf{FR- (3)}. The user needs to be able to see how their data is kept (personal data privacy).
\end{enumerate}
\subsection{Core app - Home page}
In the home page view, the user will manage their virtual gyms and gym zones. Furthermore, it will be able to create, update and remove the template classes which will be then linked to gym zones schedule.
\subsubsection{Virtual gyms}
The user will enter the home page and will see the list of their virtual gyms. If no virtual gym has been created, they will be asked if they want to create a virtual gym (which will be optional). From the same view, they will be able to create, modify and archive the different virtual gyms, aside from accessing the gym zones of that virtual gym.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The view has to display a list or a grid with the different virtual gyms of the user.
	\item \textbf{FR- (3)}. Each virtual gym item has to provide an option to visualise and update all the information of that virtual gym. This means changing both the virtual gym \emph{metadata}, and the virtual gym constraints.
	\item \textbf{FR- (3)}. The user has to access the gym zones by clicking on a virtual gym.
	\item \textbf{FR- (2)}. The user has to be able to search the virtual gyms by their name.
	\item \textbf{FR- (1)}. Each virtual gym item has to provide an option to archive that virtual gym (and, consequentially, all the gym zones).
	\item \textbf{FR- (1)}. There virtual gym list has to provide an option to programmatically sort the virtual gyms (e.g. by ascending or descending capacity).
	\item \textbf{FR- (1)}. There virtual gym list has to provide an option to manually sort the virtual gyms.
\end{enumerate}
\subsubsection{Gym zones}
Once a virtual gym has been created and the user has clicked on the card representing it, the user will be redirected to another view in which the zones of the gym will be displayed. Similarly, as in the virtual gyms view, if the user has not created any gym zone, they will be prompted to do so, if wanted.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The view has to display a list or a grid with the different gym zones of the selected virtual gym.
	\item \textbf{FR- (3)}. Each gym zone has to provide an option to visualise and update all the information of that gym zone. This means changing both the gym zone \emph{metadata}, and the gym zone constraints.
	\item \textbf{FR- (2)}. The user has to see the gym zone activity by clicking on it. The gym zone activity is understood as how many clients are currently in that zone.
	\item \textbf{FR- (2)}. The user has to be able to schedule different trainers to each non-class gym zone.
	\item \textbf{FR- (1)}. Each gym zone has to provide an option to archive the zone.
\end{enumerate}
\subsubsection{Class gym zone schedule}
When the user has created a class gym zone, that zone will have a schedule (or a calendar). Inside this view, the user will be able to see the schedule or calendar from the selected gym zone.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The view has to provide an option to visualise the current schedule of classes.
	\item \textbf{FR- (3)}. The view has to provide an option to visualise all the created template classes.
	\item \textbf{FR- (3)}. From the calendar, the user has to be able to create a guided session by linking a template class to it. Such \emph{scheduled event} must include: a start and end time, the trainer which will be the guide and a maxiumum capacity.
	\item \textbf{FR- (2)}. From the calendar, the user has to be able to see future scheduled classes.
	\item \textbf{FR- (1)}. From the calendar, the user has to be able to see past scheduled classes.
	\item \textbf{FR- (1)}. The user has to be able to create guided sessions which are repeated when wanted, from the chosen interval.
	\item \textbf{FR- (1)}. After creating a new class on a gym zone, the application has to \emph{recommend} a trainer for that class.
\end{enumerate}
\subsection{Core app - Events page}
Even though this view is simple, it is important to separate the schedule view of a gym zone from the template events. The current view will only provide the necessary tools to create, edit, delete or archive the different event templates.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The user has to be able to see the gym list of template classes.
	\item \textbf{FR- (3)}. The user has to be able to reorder the gym list of template classes.
	\item \textbf{FR- (3)}. There has to be an option in the menu which allows the user to create, update and delete template classes.
	\item \textbf{FR- (2)}. The user has to be able to archive template classes.
\end{enumerate}
\subsection{Core app - Workers page}
This view has to allow the user to manage the workers of the gym enterprise and set the different permissions.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The user has to be able to create a new worker, providing personal information and credentials for such worker to user the app. Furthermore, it has to allow the user to set the permissions for that worker.
	\item \textbf{FR- (3)}. The same menu has to provide an option to update the user permissions or the personal information of the worker.
	\item \textbf{FR- (3)}. The menu has to provide a separate option to create trainers, which will do not have access to the application.
	\item \textbf{FR- (3)}. The view has to list all the workers.
	\item \textbf{FR- (2)}. Each worker has to provide an option to archive the trainer.
	\item \textbf{FR- (1)}. The user has to be able to set the working hours of each worker.
	\item \textbf{FR- (1)}. The view has to provide an input to search the by name, last name or other characteristics the different workers.
	\item \textbf{FR- (1)}. The menu has to provide an option to sort the workers and trainers.
\end{enumerate}
\subsection{Core app - Settings page}
This view has to provide enough settings to customizer the behavior of the behavior and the gym information.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The settings menu has to allow the user to change the gym name and gym characteristics.
	\item \textbf{FR- (3)}. The settings menu has to allow the user to change their email and password.
	\item \textbf{FR- (1)}. The settings menu has to provide an option to change the application theme (light and dark) and persist it.
	\item \textbf{FR- (1)}. The settings menu has to provide an option to customise the main colours of the user interface.
\end{enumerate}
\subsection{Core app - Analysis page}
The goal of this view is to provide some metrics to \emph{what is happening at the gym}. However, as it is not the main purpose of the application, all the requirements from each will be marked with \emph{low priority}.
\begin{enumerate}[label = -]
	\item \textbf{FR- (1)}. The view has to provide a select option to choose what virtual gym wants to be analised.
	\item \textbf{FR- (1)}. After having selected a virtual gym, the view has to display in which intervals the virtual gym is most crowded at the current date.
	\item \textbf{FR- (1)}. After having selected a virtual gym, the view has to display in which intervals the virtual gym is most crowded during an interval.
	\item \textbf{FR- (1)}. After having selected a virtual gym, the view has to display what classes will have more clients during an interval.
	\item \textbf{FR- (1)}. After having selected a virtual gym, the view has to display what classes will have more clients during at the current date.
	\item \textbf{FR- (1)}. After having selected a virtual gym, the view has to provide a filter to check what gym zones are more crowded during an interval.
	\item \textbf{FR- (1)}. After having selected a virtual gym, the view has to provide a filter to check what gym zones are more crowded at the current date.
\end{enumerate}
\subsection{Client app - Home page}
The home page of the client view has to be very similar to the owner's view. The client has to see all virtual gyms to which they are subscribed, and, on accessing them, the gym zones available.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The home page has to display a list or a grid with the different virtual gyms the user has subscriptions to.
	\item \textbf{FR- (3)}. On clicking any virtual gym, the home view has to display the gym zones of the selected virtual gym.
	\item \textbf{FR- (2)}. If the user clicks on a class gym zone, a schedule has to be shown with the different classes scheduled for the selected week.
	\item \textbf{FR- (2)}. The calendar has to provide options to change the week. The user can see scheduled classes before the current date.
	\item \textbf{FR- (3)}. If the user clicks on a non-class gym zone, a form has to be shown to choose the interval in which they want to make the appointment. This includes the date of the appointment, the duration and the starting hour.
	\item \textbf{FR- (3)}. On selecting a date and a duration, the server has to return what available stating hours there are. If there is no capacity for such selections, the user will not be able to create the appointment.
	\item \textbf{FR- (1)}. On selecting a date, a duration and a starting hour, the view has to display how many reservations are at such time.
\end{enumerate}
\subsection{Client app - Personal information}
The personal information, which is nearly the settings page for the client, has to display most of their information. Additionally, it can show some user stats \emph{for the geeks}.
\begin{enumerate}[label = -]
	\item \textbf{FR- (3)}. The view has to allow the client to change his personal information (name, last name and so on).
	\item \textbf{FR- (3)}. The view has to allow the client to update his email and password.
	\item \textbf{FR- (3)}. The view has to display a list with all the upcoming appointments of the user.
	\item \textbf{FR- (1)}. If wanted, the user has to be able to see a list with all the past appointments.
	\item \textbf{FR- (1)}. The view has to display an analytics table to see which days have they accessed a virtual gym.
\end{enumerate}
\section{Non-functional requirements}
A non-functional requirement is a requirement that defines system attributes such as security, reliability, maintainability, scalability and usability. Therefore, such requisites do not describe information to keep nor functionalities to implement, rather characteristics of such functionalities. In the system, the following non-functional requirements can be defined:
\begin{enumerate}[label = -]
	\item \textbf{RNF- (3)}. The system has to provide a secure authentication method.
	\item \textbf{RNF- (2)}. The application has to provide different authentication methods in order to differentiate the gym owner, the gym worker and the gym client.
	\item \textbf{RNF- (2)}. The landing and client web applications must provide a responsive interface, so that the application can be seen both in small and large screens.
	\item \textbf{RNF- (1)}. The core application has to provide a responsive interface up to a point. In smaller screens such as phones, some functionalities would not be easy to implement nor to use.
	\item \textbf{RNF- (2)}. The three web applications have to provide an accessible and semantic HTML structure.
\end{enumerate}
\section{Requirements dependency matrix}
\chapter{Planning}
\chapter{Studies and decisions}
\section{Introduction}
This chapter will cover the different aspects that have been taken into account in order to choose the technology stack used to develop the system.
\section{Project structure}
Being able to solve problems rapidly, or even minimizing such errors, it is a must in order to provide a secure and stable application. Since \emph{test driven development} (or \emph{behavior driven development}) was designed, more and bigger companies started incorporating such approach when developing new projects. Nowadays, testing the code that is being developed is unquestionable.
\\[8pt]
Aside from the development method used, it is indisputable to use a version control system. The VCS that takes the gold medal is \emph{git} which is used alongside \emph{GitHub}. From there, the applications can be structured in two forms:
\begin{enumerate}[label = -]
	\item \emph{Multirepo}. The multirepo approach means to have multiple applications in different repositories. The main benefits of such approach are the fact that teams can separately work in the repository while at the same time the repository is kept smaller and cleaner.
	\item \emph{Monorepo}. The monorepo approach is the opposite of the multirepo: all the applications are kept in the same repository. Such approach allows maintaining build and deployment patterns altogether. However, application versioning may be harder.
\end{enumerate}
Since all the applications are build using the same language (\emph{TypeScript}) and the same package manager (\emph{npm}), the monorepo approach has been used.
\subsection{TDD and CI}
The test driven development approach has been the method to ensure that what was being written would do as expected, even when new features are added. Both client and server applications include unit and end-to-end (\emph{e2e}) tests.
\\[8pt]
Unit tests allow the developer to test a feature by isolating all its dependencies. For instance, each method of a concrete service from the backend has it own unit tests which completely mock its dependencies and ensure the behaviour is as expected. On the other hand, the e2e contexts are more complex, since they test, for example, one of the different use cases. An example would be to simulate the behaviour of the user in a client app and expect the DOM to properly change.
\\[8pt]
With testing, comes continuous integration which allows the code to be constantly tested. By constantly checking the newly added code, future errors can be prevented and \emph{post-deployment} breaks or bugs can be reduced. The chosen continuous integration platform is \emph{GitHub Actions}\footnote{The \emph{workflow} files of the platform can be found in the \texttt{.github/workflows} folder of the repository.}
\subsection{Nx}
There exist many systems or libraries that allow the development team to maintain a healthy and scalable monorepo (examples are \emph{Bazel} or \emph{Pants}). In this system, since the language is the same for both web and server applications, the monorepo build framework used that has been chosen is \emph{Nx}. As stated in their repository: \emph{Nx is a smart and extensible build framework to help you architect, test, and build at any scale}.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.2\textwidth]{assets/nx-logo.png}
	\caption{Nx logo}
\end{figure}
\\
Using such tool, managing the applications becomes extremely easy to manage both JavaScript and TypeScript monorepos. Other key features are:
\begin{enumerate}[label = -]
	\item The different applications have been \emph{generated} using the plugins also developed and maintained by the team behind Nx.
	\item The fast creation of shared libraries.
	\item Testing and building only the affected code. Therefore, in unit testing only the files that have been changed, reduces the amount of tests to be done on each push.
	\item All the created libraries and applications include all the dependencies, scripts and tools to fast serve, test, build and deploy. Additionally, it can \emph{lint} and format the projects.
	\item Provides a rich plugin ecosystem if some utilities are not included in the core package.
\end{enumerate}
More specifically, it has great support with \emph{NextJS}, which is the front-end framework used for the web apps. Being able to easily scale, maintain and test the front-end applications is a crucial requisite in this system. Such tool and its excellent documentation have simplified all aspects for setting up the different apps.
\\[8pt]
% TODO: Keep updated
After using Nx, the application folder structure is as follows:
\begin{verbatim}
gym-man
├── apps
│   ├── api
│   ├── client
│   ├── client-e2e
│   ├── core
│   ├── core-e2e
│   ├── landing
│   └── landing-e2e
└── libs
    └── shared
\end{verbatim}
There are other files in the root folder of the repository, yet they have been excluded as the main folders are \texttt{apps} and \texttt{libs}. On the one hand, the \texttt{apps} folder contains the source code and additional files to build and compile each one of them. The client apps have two folders: the source code folders (\texttt{core}, \texttt{landing} and \texttt{client}) and their respective e2e test folders (\texttt{core-e2e}, \texttt{landing-e2e} and \texttt{client-e2e}). On the other hand, the folder \texttt{libs} contains all the libraries which do not belong to an application, but rather used in many of them. As the Nx documentation states, the \texttt{libs} folder should contain: \emph{Libs contain services, components, utilities, etc. They have well-defined public API.} The front-end applications have been generated using the \texttt{@nrwl/next} utility, while the back end has been generated with \texttt{@nrwl/express}.
% TODO: Reference Nx documentation
% https://nx.dev/l/r/guides/monorepo-nx-enterprise#apps-and-libs - 12/12/2021
\section{Technology stack}
This section will cover the different technologies that are specifically used to develop the different applications.
\subsection{TypeScript}
These days JavaScript is the most used language around the world for many reasons. Nevertheless, due to the fact of not having types, it makes some applications harder to debug and more error-prone. That is one of the reasons why Microsoft developed TypeScript, which is a strict syntactical superset of JavaScript. The code written in TypeScript is transcompiled to JavaScript at build time.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.175\textwidth]{assets/js-logo.png}
	\includegraphics[width=0.175\textwidth]{assets/ts-logo.png}
	\caption{JavaScript and TypeScript logos}
\end{figure}
\\
By using TypeScript we provide a highly productive environment when developing the different apps. Not only reduces the amount of painful bugs due to type errors, but also provides all the benefits of the ECMA script.
\subsection{Front end - Web applications}
Nowadays, there are many JavaScript front-end frameworks all with their benefits and disadvantages. Angular, React, Vue and Svelte are the most known and used frameworks. Since I am most experienced with React and NextJS is built upon React, it has been the chosen option. Furthermore, on October 21st of 2021 released its 12th version which included a Rust compiler that makes rebuilds and fast refreshes extremely faster.
\subsubsection{NextJS}
As stated before, NextJS has been chosen as the front-end framework to build the applications with. This framework (or even meta-framework) is built on top of Node.js which enables React based web application functionalities such as server-side rendering (SSR) and static websites. In the NextJS home page, they provide the following description: \emph{Next.js gives you the best developer experience with all the features you need for production: hybrid static \& server rendering, TypeScript support, smart bundling, route pre-fetching, and more. No config needed}.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.2\textwidth]{assets/next-logo.png}
	\caption{NextJS logo}
\end{figure}
\subsubsection{Mui}
Once the web framework have been decided, the applications need to share a common user interface to provide the user experience of using the same product. Keeping such similarities can be difficult if the enterprise or company does not have a well-defined design system. Therefore, creating my own design system was out of scope, and a components' library, as they are called, was needed. Again, there are multiple libraries to be used, yet there is one that shines above all others, which is the \texttt{mui} library. The library is open-source and maintained by \texttt{mui-org}.
\\[8pt]
This library is based on the Google Material design system. However, it has an extremely powerful API to define your own design system, without the need of starting from 0. The developer has the possibility to inject the customised theme to all the components of the API included in the library. Furthermore, it includes an icon pack, which are the same as in the Google Material.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.2\textwidth]{assets/mui-logo.png}
	\caption{Mui library's logo}
\end{figure}
\subsection{Back end - Server application}
For the backend application, many languages can be used. However, since NodeJS provides a runtime environment for JavaScript, which allows building applications outside the browser. So, with the help on Nx, the backend is also written in TypeScript.
\subsubsection{Database}
The application has many relationships, which would be harder to maintain in a NoSQL database. Therefore, using a relational database is a better solution. At the first glance, I opted for the MySQL database since it is one of the most used SQL databases, nowadays. However, I have more experience with PostgreSQL and I had no issues with it. In the end, the chosen database has been PostgreSQL.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.2\textwidth]{assets/postgres-logo.png}
	\caption{PostgreSQL's logo}
\end{figure}
\\
As explained before the database is run in a docker container. Viewing the data in the terminal is not an issue, yet pgAdmin is a graphic user interface which simplifies such visualisation. It is the equivalent of MySQL Workbench for PostgreSQL. With such tool, schemas in general can be simply viewed and edited. Additionally, the JetBrains DataGrip application has been also used, which has allowed to generate the ERD once the database was defined.
\subsubsection{ExpressJS}
ExpressJS is one of the many back-end frameworks that exist in the JavaScript world, nowadays. It is a minimal and flexible framework which provides a fast methodology to develop APIs. It is considered the most popular back-end framework of JavaScript, up to a point that other back-end meta-frameworks are ExpressJS based (an example is NestJS). As stated in their landing page, ExpressJs is a: \emph{Fast, unopinionated, minimalist web framework for Node.js}.
% TODO: Add bibitem expressjs.com - 13/12/2021
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.2\textwidth]{assets/express-logo.png}
	\caption{ExpressJS's logo}
\end{figure}
\subsubsection{TypeORM}
Finally, the TypeORM library is used to provide a bidirectional connection from the server to the database. TypeORM is a TypeScript ORM (\emph{object relational mapper}) whose goal is to provide an agnostic model-database mapping. By using TypeScript decorators and defining a connection, TypeORM will generate the entities or documents specified, depending on the database to which is connected. Such agnosticism allows to re-use the models with different databases.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.3\textwidth]{assets/typeorm-logo.png}
	\caption{TypeORM's logo}
\end{figure}
\\
In conjunction with Nx, the models that are used to generate the entities and their relations, can be used in the front-end applications. Therefore, such models can be shared and easily maintained. By default, TypeORM does not provide an entity validation,
\subsection{Tests}
Last but not least, the test stack also had to be defined. In this case, the provided frameworks for testing by Nx were kept, since they are some of the most common testing libraries nowadays.
\subsubsection{Unit testing - Jest}
Both \texttt{@nrwl/express} and \texttt{@nrwl/next} generators set up the application with Jest. Jest is an open-source unit and mock testing framework developed and maintained by Facebook. It is one of the most popular libraries nowadays, since it is extremely powerful and simple. It offers a powerful CLI tool to control the tests which has an interactive mode that allows the developer only to run \emph{affected} tests\footnote{Nx also takes care of running only affected tests.}. Other benefits of Jest are that require zero configuration and ensures isolation between tests. Isolation is extremely important when running tests, to ensure that each test does not influence other's results. As stated in their home page: \emph{Jest is a delightful JavaScript Testing Framework with a focus in simplicity}
% TODO: Add bibitem jest.io - 13/12/2021
\\
\begin{figure}[h!]
	\centering
	% TODO: Add jest logo
	\includegraphics[width=0.3\textwidth]{assets/jest-logo.png}
	\caption{Jest's logo}
\end{figure}
\\
Therefore, Jest is used in all the applications to unit tests the services, controllers, components and so on from all the applications. Furthermore, since there is a GitHub Action, CI can be easliy acomplished.
\subsubsection{Unit testing - \texttt{@testing-library}}
Aside from unit testing API functions and so on, it is important to also test the different React components, ensuring they behave as expected. Again, there are multiple choices to develop component unit tests, yet the solution chosen is the one which is installed with \texttt{@nrlw/next}: \texttt{@testing-library}. This package provides an API to easily test React components. It is a very light library which uses functions on top of \texttt{react-dom} and \texttt{react-dom/test-utils}.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.2\textwidth]{assets/testing-library-logo.png}
	\caption{Testing library's logo}
\end{figure}
\subsubsection{Client e2e testing - Cypress}
Cypress is more than a tool for testing. It provides a graphical user interface to see what is being tested, where it fails and other features. It is an extremely powerful tool for UI testing, which has always been a difficult subject. As stated in their website, cypress enables you to: \emph{write faster, easier and more reliable tests}.
\\
\begin{figure}[h!]
	\centering
	\includegraphics[width=0.3\textwidth]{assets/cypress-logo.png}
	\caption{Cypress's logo}
\end{figure}
\\
In order to use cypress, the project needs a specific folder structure which can be a bit confusing to set up. However, the \texttt{@nrlw/next} plugin already sets up this environment, which is kept in the \texttt{*-e2e} folders\footnote{In the system case, the different cypress environments are in: \texttt{client-e2e}, \texttt{core-e2e} and \texttt{landing-e2e}.}.
\subsubsection{Server e2e testing - Jest and Supertest}
Finally, the libraries that are installed to develop end-to-end test for express, in \texttt{@nrwl/express} are: Jest and Supertest. The Jest library has already been covered. The Supertest is an HTTP assertions library that allows the developer to create Node.js HTTP tests. It uses the SuperAgent library, which is an HTTP client for Node.js. Using Supertest is one of the most common methods to develop such tests.
\chapter{Analysis and system design}
\section{Use case diagram}
\section{Use case tables}
\section{Database diagram}
\subsection{Introduction}
In a previous section, it has been explained that the DataGrip application has been used to create the database diagram. The process to create such diagram has been:
\begin{enumerate}[label = \textbf{\arabic{*}.}]
	\item Create the entities with TypeORM. The synchronization of TypeORM with the empty database, will create all the tables, sequences, indexes and so on that have been defined. Therefore, the use of SQL is minimum and can easily be debugged, if needed.
	\item Set up a connection to the dockerized database with DataGrip.
	\item Generate the ERD with the detected tables.
\end{enumerate}
Such tool allows faster diagrams visualisation and avoids the pain of having to keep ERD diagrams manually updated on any minor change,
\subsection{Diagram}
The resulting diagram is:
\begin{figure}[h!]
	\centering
	\includegraphics[width=\textwidth]{assets/db-erd.png}
	\caption{Database diagram}
\end{figure}
\subsubsection{Introduction}
%! INFO: LAST UPDATED -> 17/12/2021
In the following sections each table will be explained and a brief description of their fields will be given. Each field will be represented using the following schema:
\begin{enumerate}[label = -]
	\item \textbf{<field name>} (\texttt{<field type>}) [\texttt{<field constraints>}] \texttt{->} <field description>
\end{enumerate}
There are some fields that are common to the different entities, independently of their relations. Such fields are:
\begin{enumerate}[label = -]
	\item \textbf{created\_at} (\texttt{timestamp}) [\texttt{DEFAULT NOW()}] \texttt{->} Keeps the \emph{timestamp} at which the entity has been created.
	\item \textbf{updated\_at} (\texttt{timestamp}) [\texttt{DEFAULT NOW()}] \texttt{->} Keeps the \emph{timestamp} at which the entity has been last updated.
	\item \textbf{deleted\_at} (\texttt{timestamp}) [] \texttt{->} Keeps the \emph{timestamp} at which the entity has been dele-ted.
\end{enumerate}
\subsubsection{Person}
One of the big concepts to define in the database has been how are users stored. After comparing many approaches, a multiple table inheritance has been chosen. The base table of the user's inheritance is the \emph{Person}. The person entity will have an id which will be the primary key of the entities that inherit from the table. Such entity contains the mandatory data each user must have:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} This is the \emph{primary key} of the entity.
	\item \textbf{email} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Stores the email of the user. The email is indexed by a \emph{unique index} (\texttt{person-email-idx}).
	\item \textbf{password} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Stores the password of the user which is encrypted before insert.
	\item \textbf{first\_name} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Stores the first name of the user. This field is indexed for faster queries by first name (\texttt{person-first-name-idx}).
	\item \textbf{last\_name} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Stores the last name of the user. This field is indexed for faster queries by last name (\texttt{person-last-name-idx}).
	\item \textbf{theme} (\texttt{app\_theme}) [\texttt{DEFAULT "LIGHT"}] \texttt{->} Stores the theme used by the person in the different applications\footnote{This field is an enum defined in the library \texttt{@gym-man/shared/enums}.}.
	\item \textbf{gender} (\texttt{char}) [\texttt{NOT NULL}] \texttt{->} Stores the gender of the person.
	\item \textbf{gym\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} Stores the id of the \texttt{Gym} entity to which the user belongs.
\end{enumerate}
\subsubsection{Owner}
The \emph{Owner} entity is the person who has the most permissions. Therefore, instead of having all the permissions which are defined in the \emph{Worker} entity set to \texttt{true}, the \emph{Owner}'s are kept in a different table. Additionally, an owner will have more permissions than the ones stored in the \emph{Worker} entity. The fields of the table are:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} References an id of the \emph{Person} entity.
\end{enumerate}
\subsubsection{Worker}
The next person type is the \emph{Worker}. A worker has different permissions set by the owner when created. The \emph{Worker} entity basically contains \texttt{boolean} fields which allow the system to know what permissions have been given to the worker. The permissions of the user are set using the following rule: \texttt{<operation>\_<on>}. For example, the permission of \emph{updating} the gym zones is \texttt{u\_gym\_zone}.
\\[8pt]
The fields of the table are
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} References an id of the \emph{Person} entity.
	\item \textbf{worker\_code} (\texttt{uuid}) [\texttt{DEFAULT uuid\_generate\_v4()}] \texttt{->} Code generated by the system to identify the workers.
	\item \textbf{u\_virtual\_gym} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to update a virtual gym.
	\item \textbf{c\_gym\_zones} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to create a\\gym zone.
	\item \textbf{u\_gym\_zones} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to update a gym zone.
	\item \textbf{d\_gym\_zones} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to delete a\\gym zone.
	\item \textbf{c\_trainers} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to create a trainer.
	\item \textbf{u\_trainers} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to update a trainer.
	\item \textbf{d\_trainers} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to delete a trainer.
	\item \textbf{c\_clients} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to create a client.
	\item \textbf{u\_clients} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to update a client.
	\item \textbf{d\_clients} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to delete a client.
	\item \textbf{c\_events} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to create an event.
	\item \textbf{u\_events} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to update an event.
	\item \textbf{d\_events} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to delete an event.
	\item \textbf{c\_event\_types} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to create an event type.
	\item \textbf{u\_event\_types} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to update an event type.
	\item \textbf{d\_event\_types} (\texttt{boolean}) [\texttt{DEFAULT FALSE NOT NULL}] \texttt{->} Permission to delete an event type.
	\item \textbf{manager\_id\_fk} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the manager (owner) of the worker.
\end{enumerate}
\subsubsection{Trainer}
The trainer table is very simple since it has no interaction with the system. It is a subset of the properties of a worker.
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} References an id of the \emph{Person} entity.
	\item \textbf{worker\_code} (\texttt{uuid}) [\texttt{DEFAULT uuid\_generate\_v4()}] \texttt{->} Code generated by the system to identify the workers.
	\item \textbf{manager\_id\_fk} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the manager (owner) of the worker.
\end{enumerate}
\subsubsection{Client}
Client is a WIP entity.
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} References an id of the \emph{Person} entity.
	\item \textbf{covid\_passport} (\texttt{boolean}) [\texttt{NOT NULL DEFAULT FALSE}] \texttt{->} Allows the gym owners and workers to know if the user has registered the covid passport.
\end{enumerate}
\subsubsection{Gym}
The \emph{Gym} entity is relates to the company, not the infrastructure of a gym. Therefore, it works as a bridge entity that knows the preferences of the gym, such as the interface, gym location and other data. These properties can only be modified by an owner person. The table consists of the following fields:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} Unique id of the gym.
	\item \textbf{name} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Name of the gym, which will be displayed to the client and workers.
	\item \textbf{email} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Contact email of the gym.
	\item \textbf{phone} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Contact phone of the gym.
	\item \textbf{color} (\texttt{theme\_color}) [\texttt{DEFAULT "\#2196F3" NOT NULL}] \texttt{->} Primary color of the gym which is the same with all the users\footnote{This field is an enum defined in the library \texttt{@gym-man/shared/enums}.}.
\end{enumerate}
\subsubsection{VirtualGym}
Once the \emph{Gym} has been defined, the company may have multiple different infrastructures, for example, if it is a franchise. These virtual gyms are stored in the \emph{VirtualGym} table. The virtual gym will have different constraints which can change if the workers or owners do change them. The fields of the \emph{VirtualGym} table are:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} Unique id of the virtual gym.
	\item \textbf{name} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Name of the virtual gym.
	\item \textbf{description} (\texttt{text}) [] \texttt{->} Optional description of the virtual gym.
	\item \textbf{capacity} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} Maximum capacity of the virtual gym.
	\item \textbf{open\_time} (\texttt{timestamp}) [\texttt{NOT NULL}] \texttt{->} Time at which the virtual gym opens.
	\item \textbf{close\_time} (\texttt{timestamp}) [\texttt{NOT NULL}] \texttt{->} Time at which the virtual gym closes.
	\item \textbf{gym\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} \emph{Gym} to which the virtual gym belongs.
\end{enumerate}
\subsubsection{GymZone}
After having created the \emph{VirtualGym}, now gym zones can be created for the different virtual gyms of a gym. There are two types of zones: class and non-class zones. The class zones will have a schedule with \emph{Event}'s create by the gym personnel, while non-class zones will have a schedule without events. At the same time, it has the constraints set by the owner and workers, similar to the \emph{VirtualGym}.
\\[8pt]
The columns of the entity are:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} Unique id of the gym zone.
	\item \textbf{name} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Name of the gym zone.
	\item \textbf{description} (\texttt{text}) [] \texttt{->} Optional description of the gym zone.
	\item \textbf{is\_class\_type} (\texttt{boolean}) [\texttt{DEFAULT FALSE}] \texttt{->} Whether it is a class or non-class zone.
	\item \textbf{capacity} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} Maximum capacity of the gym zone.
	\item \textbf{mask\_required} (\texttt{boolean}) [\texttt{DEFAULT TRUE}] \texttt{->} Whether wearing the mask is mandatory to access the gym zone.
	\item \textbf{covid\_passport} (\texttt{boolean}) [\texttt{DEFAULT TRUE}] \texttt{->} Whether having registered the covid passport is mandatory to access the gym zone.
	\item \textbf{open\_time} (\texttt{timestamp}) [\texttt{NOT NULL}] \texttt{->} Time at which the gym zone opens.
	\item \textbf{close\_time} (\texttt{timestamp}) [\texttt{NOT NULL}] \texttt{->} Time at which the gym zone closes.
	\item \textbf{time\_intervals} (\texttt{time\_interval[]}) [\texttt{DEFAULT {30, 60, 90, 120}}] \texttt{->} This field will only be used if the gym zone is a non-class zone. It defines the time intervals, in minutes, that the clients will be able to make the appointments.
	\item \textbf{virtual\_gym\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} \emph{VirtualGym} to which the gym zone belongs.
\end{enumerate}
\subsubsection{Calendar}
The \emph{Calendar} entity is linked to a \emph{GymZone} and is used to link the events and to know how many clients have made an \emph{Appointment} during a time interval. The \emph{Calendar} will always be linked with \emph{Event}'s, and the \emph{Event} entity will be used to determine if the \emph{Appointment} is for a class or a non-class zone.
\\[8pt]
The fields of the table are:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} Unique id of the \emph{Calendar}.
	\item \textbf{gym\_zone\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} \emph{GymZone} to which the \emph{Calendar} belongs.
\end{enumerate}
\subsubsection{CalendarDate}
A \emph{CalendarDate} is a simple entity that will contain the year, month and day of a date. It will be created \emph{on demand}, meaning that each entry is unique, yet it will not exist until there is another entity that requires of it. With this approach, the system avoids the need to fill the table with hundreds of entries for each date. The fields are:
\begin{enumerate}[label = -]
	\item \textbf{year} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} Year of the \emph{CalendarDate}.
	\item \textbf{month} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} Month of the \emph{CalendarDate}.
	\item \textbf{day} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} Day of the \emph{CalendarDate}.
\end{enumerate}
In order to ensure each entry is unique, a \emph{composite unique index} has been set which contains the three fields of the table.
\subsubsection{EventType}
The system allows the user to create events are of a specific type. For instance, the types can be: spinning, zumba, yoga and so on. There will be predefined \emph{EventType}'s when the owner first creates the gym. However, in order to allow more flexibility while using the application, the system also allows the user to create custom \emph{EventType}'s.
\\[8pt]
The \emph{EventType} entity is composed by the following columns:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} Unique id of the \emph{EventType}.
	\item \textbf{name} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Name of the \emph{EventType}.
	\item \textbf{description} (\texttt{text}) \texttt{->} Optional description for the \emph{EventType}.
	\item \textbf{label\_color} (\texttt{app\_palette}) [\texttt{DEFAULT "\#2196F3" NOT NULL}] \texttt{->} Color of the \emph{EventType} when displayed.
	\item \textbf{gym\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the id to which the \emph{EventType} belongs.
\end{enumerate}
\subsubsection{EventTemplate}
In order to reduce the repetitive process of creating \emph{Event}'s for a gym zone, the system provides the utility of creating \emph{EventTemplate}'s, which allow the owners or workers to create \emph{Event}'s faster. With the \emph{EventTemplate} utility, in order to create an \emph{Event} becomes faster and less repetitive.
\\[8pt]
The fields of this entity are:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY AUTOINCREMENT}] \texttt{->} Unique id of the \emph{EventTemplate}.
	\item \textbf{name} (\texttt{varchar(255)}) [\texttt{NOT NULL}] \texttt{->} Name of the \emph{EventTemplate}.
	\item \textbf{description} (\texttt{text}) \texttt{->} Optional description for the \emph{EventTemplate}.
	\item \textbf{event\_type\_fk} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{EventType} of the \emph{EventTemplate}.
\end{enumerate}
\subsubsection{Event}
Finally, the \emph{Event} can be defined. An \emph{Event} is a bridge table that contains: the \emph{Trainer}, the \emph{CalendarDate}, the \emph{Calendar} to which is scheduled and the \emph{EventTemplate}. All these identify the \emph{Event}, that is what the entity to which the user will be able to create an appointment.
\\[8pt]
The table is defined as:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY FIELD NOT NULL}] \texttt{->} Unique identifier of the \emph{Event}.
	\item \textbf{trainer\_person} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{Trainer} of the \emph{Event}.
	\item \textbf{calendar\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{Calendar} of the \emph{Event}.
	\item \textbf{template\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{EventTemplate} of the \emph{Event}.
	\item \textbf{date\_year} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the year of a \emph{CalendarDate} of the \emph{Event}.
	\item \textbf{date\_month} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the month of a \emph{CalendarDate} of the \emph{Event}.
	\item \textbf{date\_day} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the day of a \emph{CalendarDate} of the \emph{Event}.
\end{enumerate}
\subsubsection{EventAppointment and CalendarAppointment}
Finally, the only requirement left is the appointments from the \emph{Client}'s. The \emph{Client} has to be able to book a session for a guided class, which means to an \emph{Event}, or for a non-guided class, that is for a \emph{Calendar}. So, the two entities represent each case respectively. They both share some attributes, such as the \texttt{startTime} and the \texttt{openTime}. However, the \emph{EventAppointment} is related with an \emph{Event}, as it will be an \emph{Appointment} made to an \emph{Event}. On the other hand, a \emph{CalendarAppointment} would be an \emph{Appointment} made in a time interval, chosen by the user, for a specific \emph{GymZone}.
\\[8pt]
The fields of the \emph{EventAppointment} entity are:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY NOT NULL}] \texttt{->} Unique identifier of the \emph{EventAppointment}
	\item \textbf{client\_person} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{Client} that has made the \emph{EventAppointment}.
	\item \textbf{event\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{Event} to which the \emph{EventAppointment} has been made.
	\item \textbf{start\_time} (\texttt{time}) [\texttt{NOT NULL}] \texttt{->} Time at which the \emph{EventAppointment} starts, which will be the same as the \emph{Event}.
	\item \textbf{end\_time} (\texttt{time}) [\texttt{NOT NULL}] \texttt{->} Time at which the \emph{EventAppointment} ends, which will be the same as the \emph{Event}.
	\item \textbf{cancelled} (\texttt{boolean}) [\texttt{NOT NULL DEFAULT FALSE}] \texttt{->} Used to know if the \emph{EventAppointment} has been cancelled.
\end{enumerate}
The fields of the \emph{EventAppointment} entity are:
\begin{enumerate}[label = -]
	\item \textbf{id} (\texttt{integer}) [\texttt{PRIMARY KEY NOT NULL}] \texttt{->} Unique identifier of the \emph{CalendarAppointment}
	\item \textbf{client\_person} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{Client} that has made the \emph{CalendarAppointment}.
	\item \textbf{calendar\_id} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the \emph{Calendar} to which the \emph{CalendarAppointment} has been made.
	\item \textbf{start\_time} (\texttt{time}) [\texttt{NOT NULL}] \texttt{->} Time at which the \emph{CalendarAppointment} starts.
	\item \textbf{end\_time} (\texttt{time}) [\texttt{NOT NULL}] \texttt{->} Time at which the \emph{CalendarAppointment} ends.
	\item \textbf{cancelled} (\texttt{boolean}) [\texttt{NOT NULL DEFAULT FALSE}] \texttt{->} Used to know if the \emph{CalendarAppointment} has been cancelled.
	\item \textbf{date\_year} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the year of a \emph{CalendarDate} of the \emph{CalendarAppointment}.
	\item \textbf{date\_month} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the month of a \emph{CalendarDate} of the \emph{CalendarAppointment}.
	\item \textbf{date\_day} (\texttt{integer}) [\texttt{NOT NULL}] \texttt{->} References the day of a \emph{CalendarDate} of the \emph{CalendarAppointment}.
\end{enumerate}
\chapter{Implementation and trials}
\chapter{Conclusions}
\chapter{Future work}
\appendix
\chapter{Bibliography}
\chapter{User manual or installation}
\end{document}